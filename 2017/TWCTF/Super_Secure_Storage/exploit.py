import urllib2
import urllib

'''curl 'http://s3.chal.ctf.westerns.tokyo/api/data' -H 'Origin: http://s3.chal.ctf.westerns.tokyo' -H 'Accept-Encoding: gzip, deflate' -H 'Accept-Language: ko-KR,ko;q=0.8,en-US;q=0.6,en;q=0.4,ja;q=0.2' -H 'User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_12_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/60.0.3112.113 Safari/537.36' -H 'Content-Type: application/json;charset=UTF-8' -H 'Accept: application/json, text/plain, */*' -H 'Referer: http://s3.chal.ctf.westerns.tokyo/' -H 'Connection: keep-alive' --data-binary '{"data":"ABCDEFG","key":"11111111"}' --compressed'''

URL = "http://s3.chal.ctf.westerns.tokyo/api/data"

print "!X\x81)\xd3\x01\xad".encode('hex')

while 1:
	data = raw_input("Data > ")
	key = raw_input("Key > ")
	#query = '{"data":"%s","key":"%s"}'%(data,key)
	query = '{"data":"%s","key":"%s"}'%('!X%81)%d3%01%ad',key)
	req = urllib2.Request(URL,query)
	req.add_header("Accept","application/json, text/plain, */*")
	req.add_header("Origin","http://s3.chal.ctf.westerns.tokyo")
	req.add_header("User-Agent","Mozilla/5.0 (Macintosh; Intel Mac OS X 10_12_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/60.0.3112.113 Safari/537.36")
	req.add_header("Content-Type","application/json;charset=UTF-8")
	req.add_header("Referer","http://s3.chal.ctf.westerns.tokyo/")
	res = urllib2.urlopen(req)
	print res.read()


	
'''
	r= requests.get(URL,json={"data":data,"key":key})
	print(r.text)
	print()
'''
